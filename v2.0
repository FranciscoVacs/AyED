# Bonaroti, Francisco 111
# Cosenza, Teo 107
# Gilardoni, Lucio 107
# Vacs, Francisco 107

# en un ppio anda, falta bastante testeo + arreglar el chapin donde aplique

import os


def menu_principal():
    os.system("cls")
    print("MENU PRINCIPAL:")
    print("\t 1 - ADMINISTRACIONES")
    print("\t 2 - ENTREGA DE CUPOS")
    print("\t 3 - RECEPCION")
    print("\t 4 - REGISTRAR CALIDAD")
    print("\t 5 - REGISTRAR PESO BRUTO")
    print("\t 6 - REGISTRAR DESCARGA")
    print("\t 7 - REGISTRAR CARGA")
    print("\t 8 - REPORTES")
    print("\t 0 - FIN DEL PROGRAMA")


def menu_administraciones(cargados):
    seleccion = ""
    while seleccion != "V":
        while seleccion not in ("A", "B", "C", "D", "E", "F", "G", "V"):
            os.system("cls")
            print("ADMINISTRACIONES")
            print("\t A- TITULARES")
            print("\t B- PRODUCTOS")
            print("\t C- RUBROS")
            print("\t D- RUBROS x PRODUCTO")
            print("\t E- SILOS")
            print("\t F- SUCURSALES")
            print("\t G- PRODUCTO POR TITULAR ")
            print("\t V- VOLVER AL MENU PRINCIPAL")
            seleccion = input("Seleccione una opcion: ").upper()
            if seleccion not in ("A", "B", "C", "D", "E", "F", "G", "V"):
                print("No existe la opcion\n")
                os.system("pause")
                seleccion = ""
        if seleccion != "V":
            menu_opciones(seleccion, cargados)
            seleccion = ""


def menu_opciones(x, cargados):
    seleccion = ""
    while seleccion != "V":
        while seleccion not in ("A", "B", "C", "M", "V"):
            os.system("cls")
            print("OPCIONES")
            print("\t A - ALTA")
            print("\t B - BAJA")
            print("\t C - CONSULTA")
            print("\t M - MODIFICACION")
            print("\t V - VOLVER")
            seleccion = input("Seleccione una opcion: ").upper()
            if seleccion not in ("A", "B", "C", "M", "V"):
                print("No existe la opcion\n")
                os.system("pause")
            if seleccion != "V":
                if x == "B":
                    edicion(seleccion, cargados)
                else:
                    print("Esta funcionalidad esta en construccion\n")
                    os.system("pause")
                seleccion = ""


def edicion(x, cargados):
    productos = ["SOJA", "TRIGO", "MAIZ", "GIRASOL", "CEBADA"]
    prod_elegido = ""
    not_repe = 1
    match x:

        case "A":
            if " " not in cargados:
                print("Los tres estan llenos, borra o modifica uno")
                os.system("pause")
            else:
                while prod_elegido not in productos:
                    os.system("cls")
                    print("PRODUCTOS")
                    print(productos)
                    prod_elegido = input("Producto a cargar: ").upper()
                    if prod_elegido not in productos:
                        print("El producto ingresado no existe")
                        os.system("pause")
                i = 0
                while i < 3 and cargados[i] != prod_elegido:
                    i += 1
                if i < 3:
                    print("El producto ya estÃ¡ cargado")
                    os.system("pause")
                    not_repe = 0
                i = 0
                while cargados[i] != " ":
                    i += 1
                if not_repe:
                    cargados[i] = prod_elegido

        case "B":
            if cargados[0] == " " and cargados[1] == " " and cargados[2] == " ":
                os.system("cls")
                print("Todavia no se cargo ningun producto")
                os.system("pause")
            else:
                while prod_elegido not in productos:
                    os.system("cls")
                    print(cargados)
                    prod_elegido = input("Ingrese el producto a eliminar: ").upper()
                    if prod_elegido not in cargados:
                        print("Lo ingresado no es un producto cargado")
                        os.system("pause")
                i = 0
                while prod_elegido != cargados[i]:
                    i += 1
                cargados[i] = " "

        case "C":
            if cargados[0] == " " and cargados[1] == " " and cargados[2] == " ":
                os.system("cls")
                print("Todavia no se cargo ningun producto")
                os.system("pause")
            else:
                os.system("cls")
                print(cargados)
                os.system("pause")

        case "M":
            if cargados[0] == " " and cargados[1] == " " and cargados[2] == " ":
                os.system("cls")
                print("Todavia no se cargo ningun producto")
                os.system("pause")
            else:
                prod_sacar = ""
                prod_nuevo = ""
                while prod_sacar not in cargados:
                    os.system("cls")
                    print(cargados)
                    prod_sacar = input("Ingrese el producto a modificar: ").upper()
                    if prod_sacar not in cargados:
                        print("El producto ingresado no esta cargado")
                        os.system("pause")
                while prod_nuevo not in productos or prod_nuevo in cargados:
                    os.system("cls")
                    print(productos)
                    prod_nuevo = input("Ingrese el nuevo producto: ").upper()
                    if prod_nuevo not in productos and prod_nuevo in cargados:
                        print("El producto ingresado no corresponde")
                i = 0
                while prod_sacar != cargados[i]:
                    i += 1
                cargados[i] = prod_nuevo


def entrega_cupos(camiones, estado,cargados):
    os.system("cls")
    if cargados[0]=="" and cargados[1]=="" and cargados[2]=="":
        print("Todavia no se cargo ningun producto, cargue uno y vuelva")
        os.system("pause")
    else:
        while otro:
            otro=False
            i=0
            while i<8 and camiones[i][0]!="":#se fija que haya uno vacio y donde
                i+=1
            if i<8: #si hay uno vacio
                libre=i
                new_patente=""
                while (len(new_patente)<6 or len(new_patente)>7):
                    new_patente=input("Ingrese la nueva patente: ")
                    if len(new_patente)<6 or len(new_patente)>7:
                        print("Patente no aceptada")
                        os.system("pause")
                i=0
                while new_patente!=camiones[i][0] and camiones[i][0]!="":#chequea q no repita hasta la 1ra vacia
                    i+=1
                if camiones[i][0]=="":
                    i=0
                    producto=""
                    productos = ["SOJA", "TRIGO", "MAIZ", "GIRASOL", "CEBADA"]
                    while producto not in productos:
                        producto=input("Ingrese el producto transportado: ")
                        if producto not in productos:
                            print("Producto no reconocido")
                            os.system("pause")
                    if producto not in cargados:
                        print("Producto no cargado, cargue y vuelva")
                        os.system("pause")
                    else:
                        camiones[libre][1]=producto
                        camiones[libre][0]=new_patente
                        estado[libre]='P'
                    
                else:
                    print("Patente ya ingresada")
                    os.system("pause")
                rta=""
                while rta!="S" and rta!="N":
                    rta=input("Obtener otro cupo? S/N")
                    if rta!="S" and rta!="N":
                        print("Rta no aceptada")
                        os.system("pause")
                if rta=="S":
                    otro=True
            else:
                print("No quedan cupos disponibles")
                os.system("pause")

#iterar con fin de proceso
def menu_recepcion(camiones, estado):
    os.system("cls")
    new_patente=""
    while (len(new_patente)<6 or len(new_patente)>7) and new_patente!="*":
        new_patente=input("Ingrese la nueva patente (* para finalizar): ")
        if (len(new_patente)<6 or len(new_patente)>7) and new_patente!="*":
            print("Patente no aceptada")
            os.system("pause")
    if new_patente!="*":
        i=0
        while i<8 and camiones[i][0]!=new_patente:
            i+=1
        if i==8:
            print("Patente sin cupo")
            os.system("pause")
        elif estado[i]!='P':
            print("Patente ya recibida")
            os.system("pause")
        else:
            estado[i]='E'


def registro_pb(camiones, estado, pesos):
    os.system("cls")
    if camiones[0][0]!="":
        patente=""
        while len(patente)<6 or len(patente)>7:
            patente=input("Ingrese la patente del camion: ")
            if len(patente)<6 or len(patente)>7:
                print("Patente no aceptada")
                os.system("pause")
        i=0
        while i<8 and patente!=camiones[i][0]:
            i+=1
        if i<8:
            if estado[i]=='E' and pesos[i][0]==0:
                pesos[i][0]=int(input("Ingrese el peso bruto del camion: "))
            elif estado[i]!='E':
                print("El camion no fue recibido")
                os.system("pause")
            else:
                print("El peso bruto de este camion ya fue registrado")
                os.system("pause")
    else:
        print("Todavia no se asigno ningun cupo")
        os.system("pause")


def registro_tara(camiones, estado, pesos):
    os.system("cls")
    if camiones[0][0]!="":
        patente=""
        while len(patente)<6 or len(patente)>7:
            patente=input("Ingrese la patente del camion: ")
            if len(patente)<6 or len(patente)>7:
                print("Patente no aceptada")
                os.system("pause")
        i=0
        while i<8 and patente!=camiones[i][0]:
            i+=1
        if i<8:
            if estado[i]=='E' and pesos[i][0]!=0 and pesos[i][1]==0:
                while pesos[i][1]<=pesos[i][0]:
                    pesos[i][1]=int(input("Ingrese la tara del camion: "))
                    if pesos[i][1]<=pesos[i][0]:
                        print("La tara debe ser menor o igual al peso bruto")
                        os.system("pause")
            elif estado[i]!='E':
                print("El camion no fue recibido")
                os.system("pause")
            elif pesos[i][0]==0:
                print("Previamente se debe registrar el peso bruto")
                os.system("pause")
            else:
                print("El peso bruto de este camion ya fue registrado")
                os.system("pause")
    else:
        print("Todavia no se asigno ningun cupo")
        os.system("pause")


# programa main

cargados = [" "] * 3
camiones=[""]*8
for i in range(8):
    camiones[i]=[""]*2
estado=["-"]*8
pesos = [0]*8
for i in range(8):
    pesos[i]=[0]*3

seleccion = "-"
while seleccion != "0":
    menu_principal()
    seleccion = input("Seleccione una opcion: ")

    if seleccion == "1":
        menu_administraciones(cargados)

    elif seleccion == "2":
        entrega_cupos(camiones,estado,cargados[:])

    elif seleccion in ("4", "6"):
        print("Esta funcionalidad esta en construccion\n")
        os.system("pause")

    elif seleccion == "3":
        menu_recepcion(camiones[:], estado)

    elif seleccion == "5":
        registro_pb(camiones[:],estado[:],pesos)

    elif seleccion == "7":
        registro_tara(camiones[:],estado[:],pesos)

    # elif seleccion == "8":
    # reportes()

    elif seleccion == "0":
        print("FIN DEL PROGRAMA")

    else:
        print("Opcion incorrecta, seleccione otra")
        os.system("pause")
